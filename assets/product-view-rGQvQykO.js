import{j as e,Q as J,T as C,P as n,B as Y,R as Z,K as ee,I as te,U as ne,r as l,E as ae,F as se,S as re,X as oe,G as ie}from"./index-DofQ_auc.js";import{T as R,a as p,C as ce,b as le,c as de,d as ue,e as pe,f as he,g as xe,h as ge}from"./search-fill-BmqOMkbm.js";import{O as fe}from"./Select-D4BCtFMC.js";import{C as be}from"./Container-4AE898d3.js";import{C as me}from"./Card-CHjFTr5O.js";const ye={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function je(s,r,o){return s?Math.max(0,(1+s)*r-o):0}function q({query:s}){return e.jsx(R,{children:e.jsx(p,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(J,{sx:{textAlign:"center"},children:[e.jsx(C,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(C,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',s,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}q.propTypes={query:n.string};function F({emptyRows:s,height:r}){return s?e.jsx(R,{sx:{...r&&{height:r*s}},children:e.jsx(p,{colSpan:9})}):null}F.propTypes={emptyRows:n.number,height:n.number};function H({id:s,default_code:r,name:o,category:h,type:c,lst_price:a,description_sale:x,attributes:f,virtual_available:b,qty_available:P,onSelect:m}){const _=d=>`$${d.toFixed(2)}`;return e.jsxs(R,{hover:!0,tabIndex:-1,onClick:()=>m({id:s,default_code:r,name:o,category:h,type:c,lst_price:a,description_sale:x,attributes:f,virtual_available:b,qty_available:P}),children:[e.jsx(p,{children:r}),e.jsx(p,{children:o}),e.jsx(p,{children:h}),e.jsx(p,{children:c}),e.jsx(p,{children:_(a)}),e.jsx(p,{children:x}),e.jsx(p,{children:f.map((d,w)=>e.jsx(ce,{label:d,variant:"outlined"},w))}),e.jsx(p,{children:P})]})}H.propTypes={id:n.any,default_code:n.any,name:n.any,category:n.any,type:n.any,lst_price:n.any,description_sale:n.any,attributes:n.arrayOf(n.string),virtual_available:n.any,qty_available:n.any,onSelect:n.func};function A({order:s,orderBy:r,headLabel:o,onRequestSort:h}){const c=a=>x=>{h(x,a)};return e.jsx(le,{children:e.jsx(R,{children:o.map(a=>e.jsx(p,{align:a.align||"left",sortDirection:r===a.id?s:!1,sx:{width:a.width,minWidth:a.minWidth},children:e.jsxs(de,{hideSortIcon:!0,active:r===a.id,direction:r===a.id?s:"desc",onClick:c(a.id),children:[a.label,r===a.id?e.jsx(Y,{sx:{...ye},children:s==="desc"?"sorted descending":"sorted ascending"}):null]})},a.id))})})}A.propTypes={order:n.oneOf(["asc","desc"]),orderBy:n.string,headLabel:n.array,onRequestSort:n.func};function B({filterName:s,onFilterName:r,onClickSearch:o,onHitEnter:h}){return e.jsx(Z,{sx:{height:96,display:"flex",justifyContent:"space-between",p:c=>c.spacing(0,1,0,3)},children:e.jsx(fe,{value:s,onChange:r,onKeyDown:h,placeholder:"Search product...",endAdornment:e.jsx(ee,{position:"end",children:e.jsx(te,{onClick:o,edge:"end",children:e.jsx(ne,{icon:ue,sx:{color:"text.disabled",width:20,height:20}})})})})})}B.propTypes={filterName:n.string,onFilterName:n.func,onClickSearch:n.func,onHitEnter:n.func};function Se({showTitle:s,onSelect:r}){const[o,h]=l.useState([]),[c,a]=l.useState(0),[x,f]=l.useState(0),[b,P]=l.useState("asc"),[m,_]=l.useState("name"),[d,w]=l.useState(""),[u,D]=l.useState(25),[L,z]=l.useState(0),$=l.useRef(o),N=l.useRef(u),E=l.useRef(c),O=l.useRef(d);l.useEffect(()=>{$.current=o,N.current=u,E.current=c,O.current=d,v(E.current,N.current,$.current,O.current)},[]);const v=(t,i,g,y,j,I)=>{console.log("Fetching Products");const X=t+1;let S=`${ie.baseURL}/api-proxy/proxy?method=get&resource=products&page=${X}&page_size=${i}`;y&&(S+=`&name=${y}`),j&&(S+=`&order=${j}`),I&&(S+=`&orderby=${I}`),console.log(S),ae.get(S,{headers:{Authorization:`Bearer ${se.get("jwt")}`}}).then(T=>{console.log(T.data.data),h([...g,...T.data.data]),z(T.data.count)}).catch(T=>{console.error("Error fetching products:",T)})},U=(t,i)=>{console.log("Handling Sort");const g=m===i&&b==="asc";if(i!==""){const y=g?"desc":"asc",j=i;P(y),_(j),W(y,j)}},W=(t,i)=>{console.log(`Sorting ${i} ${t}`),a(0),f(0),v(0,u,[],d,t,i)},K=(t,i)=>{a(i);const g=u*i;g>x&&(f(g),v(i,u,o,d,b,m))},M=t=>{a(0),D(parseInt(t.target.value,10))},Q=t=>{w(t.target.value)},G=t=>{t.key==="Enter"&&k()},k=t=>{a(0),v(c,u,[],d)},V=!o.length&&!!d;return e.jsxs(be,{children:[s&&e.jsx(re,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsx(C,{variant:"h4",children:"Products"})}),e.jsxs(me,{children:[e.jsx(B,{filterName:d,onFilterName:Q,onClickSearch:k,onHitEnter:G}),e.jsx(oe,{children:e.jsx(pe,{sx:{overflow:"unset"},children:e.jsxs(he,{sx:{minWidth:800},children:[e.jsx(A,{order:b,orderBy:m,rowCount:o.length,onRequestSort:U,headLabel:[{id:"default_code",label:"Default Code"},{id:"name",label:"Name"},{id:"category",label:"Category"},{id:"type",label:"Type"},{id:"lst_price",label:"Sale Price"},{id:"description_sale",label:"Description"},{id:"attributes",label:"Attributes"},{id:"qty_available",label:"Quantity on Hand"}]}),e.jsxs(xe,{children:[o.slice(c*u,c*u+u).map(t=>e.jsx(H,{id:t.id,default_code:t.default_code,name:t.name,category:t.categ_id.name,type:t.type,lst_price:t.lst_price,description_sale:t.description_sale,attributes:t.product_template_attribute_value_ids.map(i=>`${i.attribute}:${i.name}`),virtual_available:t.virtual_available,qty_available:t.qty_available,onSelect:r},t.id)),e.jsx(F,{height:77,emptyRows:je(c,u,o.length)}),V&&e.jsx(q,{query:d})]})]})})}),e.jsx(ge,{page:c,component:"div",count:L,rowsPerPage:u,onPageChange:K,rowsPerPageOptions:[25],onRowsPerPageChange:M})]})]})}Se.propTypes={showTitle:n.bool,onSelect:n.func};export{Se as P};
