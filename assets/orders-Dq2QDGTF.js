import{j as e,Q as te,T as w,P as a,h as ne,B as S,n as F,r as d,t as re,R as ae,K as oe,I as se,U as ie,C as ce,V as le,E as de,F as ue,S as pe,X as he,G as xe,W as ge}from"./index-DofQ_auc.js";import{T as k,a as u,b as fe,c as me,d as be,C as je,e as ye,f as _e,g as Te,h as Ce}from"./search-fill-BmqOMkbm.js";import{O as Re}from"./Select-D4BCtFMC.js";import{C as Se}from"./Container-4AE898d3.js";import{C as ke}from"./Card-CHjFTr5O.js";import{u as Oe}from"./use-auth-DCk-Sv54.js";const ve={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function Pe(t,n,s){return t?Math.max(0,(1+t)*n-s):0}function L({query:t}){return e.jsx(k,{children:e.jsx(u,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(te,{sx:{textAlign:"center"},children:[e.jsx(w,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(w,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',t,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}L.propTypes={query:a.string};const we=ne(S)(({theme:t,ownerState:n})=>{const s=t.palette.mode==="light",l=n.variant==="filled",i=n.variant==="outlined",o=n.variant==="soft",x={...n.color==="default"&&{...l&&{color:s?t.palette.common.white:t.palette.grey[800],backgroundColor:t.palette.text.primary},...i&&{backgroundColor:"transparent",color:t.palette.text.primary,border:`2px solid ${t.palette.text.primary}`},...o&&{color:t.palette.text.secondary,backgroundColor:F(t.palette.grey[500],.16)}}},g={...n.color!=="default"&&{...l&&{color:t.palette[n.color].contrastText,backgroundColor:t.palette[n.color].main},...i&&{backgroundColor:"transparent",color:t.palette[n.color].main,border:`2px solid ${t.palette[n.color].main}`},...o&&{color:t.palette[n.color][s?"dark":"light"],backgroundColor:F(t.palette[n.color].main,.16)}}};return{height:24,minWidth:24,lineHeight:0,borderRadius:6,cursor:"default",alignItems:"center",whiteSpace:"nowrap",display:"inline-flex",justifyContent:"center",textTransform:"capitalize",padding:t.spacing(0,.75),fontSize:t.typography.pxToRem(12),fontWeight:t.typography.fontWeightBold,transition:t.transitions.create("all",{duration:t.transitions.duration.shorter}),...x,...g}}),B=d.forwardRef(({children:t,color:n="default",variant:s="soft",startIcon:l,endIcon:i,sx:o,...x},g)=>{const f=re(),m={width:16,height:16,"& svg, img":{width:1,height:1,objectFit:"cover"}};return e.jsxs(we,{ref:g,component:"span",ownerState:{color:n,variant:s},sx:{...l&&{pl:.75},...i&&{pr:.75},...o},theme:f,...x,children:[l&&e.jsxs(S,{sx:{mr:.75,...m},children:[" ",l," "]}),t,i&&e.jsxs(S,{sx:{ml:.75,...m},children:[" ",i," "]})]})});B.propTypes={children:a.node,endIcon:a.object,startIcon:a.object,sx:a.object,variant:a.oneOf(["filled","outlined","ghost","soft"]),color:a.oneOf(["default","primary","secondary","info","success","warning","error"])};function I({name:t,customer:n,create_date:s,amount_untaxed:l,amount_tax:i,amount_total:o,state:x,x_studio_notes:g,client_order_ref:f,ship_date:m,ship_tracking_number:C,handleClick:O}){const p=v=>`$${v.toFixed(2)}`;return e.jsxs(k,{hover:!0,tabIndex:-1,onClick:O,children:[e.jsx(u,{children:t}),e.jsx(u,{children:n}),e.jsx(u,{children:s}),e.jsx(u,{children:p(l)}),e.jsx(u,{children:p(i)}),e.jsx(u,{children:p(o)}),e.jsx(u,{children:e.jsx(B,{color:x!=="draft"&&"error"||"success",children:x})}),e.jsx(u,{children:g}),e.jsx(u,{children:f}),e.jsx(u,{children:m}),e.jsx(u,{children:C})]})}I.propTypes={name:a.any,customer:a.any,create_date:a.any,amount_untaxed:a.any,amount_tax:a.any,amount_total:a.any,state:a.any,x_studio_notes:a.any,client_order_ref:a.any,ship_date:a.any,ship_tracking_number:a.any,handleClick:a.func};function D({order:t,orderBy:n,headLabel:s,onRequestSort:l}){const i=o=>x=>{l(x,o)};return e.jsx(fe,{children:e.jsx(k,{children:s.map(o=>e.jsx(u,{align:o.align||"left",sortDirection:n===o.id?t:!1,sx:{width:o.width,minWidth:o.minWidth},children:e.jsxs(me,{hideSortIcon:!0,active:n===o.id,direction:n===o.id?t:"desc",onClick:i(o.id),children:[o.label,n===o.id?e.jsx(S,{sx:{...ve},children:t==="desc"?"sorted descending":"sorted ascending"}):null]})},o.id))})})}D.propTypes={order:a.oneOf(["asc","desc"]),orderBy:a.string,headLabel:a.array,onRequestSort:a.func};function H({emptyRows:t,height:n}){return t?e.jsx(k,{sx:{...n&&{height:n*t}},children:e.jsx(u,{colSpan:9})}):null}H.propTypes={emptyRows:a.number,height:a.number};function W({filterName:t,onFilterName:n,onClickSearch:s,onHitEnter:l}){return e.jsx(ae,{sx:{height:96,display:"flex",justifyContent:"space-between",p:i=>i.spacing(0,1,0,3)},children:e.jsx(Re,{value:t,onChange:n,onKeyDown:l,placeholder:"Search order...",endAdornment:e.jsx(oe,{position:"end",children:e.jsx(se,{onClick:s,edge:"end",children:e.jsx(ie,{icon:be,sx:{color:"text.disabled",width:20,height:20}})})})})})}W.propTypes={filterName:a.string,onFilterName:a.func,onClickSearch:a.func,onHitEnter:a.func};function Ne(){const t=ce(),n=le(),[s,l]=d.useState([]),[i,o]=d.useState(0),[x,g]=d.useState(0),[f,m]=d.useState("asc"),[C,O]=d.useState("name"),[p,v]=d.useState(""),[h,q]=d.useState(25),[z,U]=d.useState(0),V=d.useRef(s),N=d.useRef(h),$=d.useRef(i),P=d.useRef(p);d.useEffect(()=>{const c=new URLSearchParams(n.search).get("search")||"";V.current=s,N.current=h,$.current=i,c?P.current=c:P.current=p,R($.current,N.current,[],P.current)},[n.search]);const R=(r,c,b,j,y,A)=>{console.log("Fetching Orders");const ee=r+1;let _=`${xe.baseURL}/api-proxy/proxy?method=get&resource=orders&page=${ee}&page_size=${c}`;j&&(_+=`&name=${j}`),y&&(_+=`&order=${y}`),A&&(_+=`&orderby=${A}`),console.log(_),de.get(_,{headers:{Authorization:`Bearer ${ue.get("jwt")}`}}).then(T=>{console.log(T.data.data),l([...b,...T.data.data]),U(T.data.count)}).catch(T=>{console.error("Error fetching orders:",T)})},M=(r,c)=>{console.log("Handling Sort");const b=C===c&&f==="asc";if(c!==""){const j=b?"desc":"asc",y=c;m(j),O(y),K(j,y)}},K=(r,c)=>{console.log(`Sorting ${c} ${r}`),o(0),g(0),R(0,h,[],p,r,c)},X=(r,c)=>{o(c);const b=h*c;b>x&&(g(b),R(c,h,s,p))},G=r=>{o(0),q(parseInt(r.target.value,10))},Q=r=>{v(r.target.value)},J=r=>{r.key==="Enter"&&E()},E=r=>{o(0),R(i,h,[],p)},Y=(r,c)=>{t.push(`/orders/${c}`)},Z=!s.length&&!!p;return e.jsxs(Se,{children:[e.jsx(pe,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsxs(w,{variant:"h4",children:["Orders",e.jsx(je,{label:"Create",color:"primary",variant:"outlined",style:{marginLeft:"10px"},onClick:()=>t.push("/new-order")})]})}),e.jsxs(ke,{children:[e.jsx(W,{filterName:p,onFilterName:Q,onClickSearch:E,onHitEnter:J}),e.jsx(he,{children:e.jsx(ye,{sx:{overflow:"unset"},children:e.jsxs(_e,{sx:{minWidth:800},children:[e.jsx(D,{order:f,orderBy:C,rowCount:s.length,onRequestSort:M,headLabel:[{id:"name",label:"Name"},{id:"shipping_addresses",label:"Shipping Addresses"},{id:"create_date",label:"Create Date"},{id:"amount_untaxed",label:"Amount Untaxed"},{id:"amount_tax",label:"Amount Tax"},{id:"amount_total",label:"Amount Total"},{id:"state",label:"State"},{id:"x_studio_notes",label:"Notes"},{id:"client_order_ref",label:"PO Number"},{id:"ship_date",label:"Ship Date"},{id:"ship_tracking_number",label:"Tracking #"}]}),e.jsxs(Te,{children:[s.slice(i*h,i*h+h).map(r=>e.jsx(I,{name:r.name,customer:r.customer_id.name,create_date:r.create_date,amount_untaxed:r.amount_untaxed,amount_tax:r.amount_tax,amount_total:r.amount_total,state:r.state,x_studio_notes:r.x_studio_notes,client_order_ref:r.client_order_ref,ship_date:r.ship_date,ship_tracking_number:r.ship_tracking_number,handleClick:c=>Y(c,r.id)},r.id)),e.jsx(H,{height:77,emptyRows:Pe(i,h,s.length)}),Z&&e.jsx(L,{query:p})]})]})})}),e.jsx(Ce,{page:i,component:"div",count:z,rowsPerPage:h,onPageChange:X,rowsPerPageOptions:[25],onRowsPerPageChange:G})]})]})}function Ie(){return Oe(),e.jsxs(e.Fragment,{children:[e.jsx(ge,{children:e.jsx("title",{children:" Order | BEX Dropship "})}),e.jsx(Ne,{})]})}export{Ie as default};
